./single_particle/archive/motion_refinement.cpp
./single_particle/archive/refinement_program.cpp
./single_particle/archive/apps/ref_aberration_plot.cpp
./single_particle/archive/apps/update_angles.cpp
./single_particle/archive/apps/em_motion.cpp
./single_particle/archive/frame_merge.cpp
./single_particle/archive/motion_em.cpp
./single_particle/Fourier_helper.cpp
./single_particle/volume_integration.cpp
./single_particle/structure_tensor.cpp
./single_particle/fftw_helper.cpp
./single_particle/new_reference_map.cpp
./single_particle/ctf/defocus_estimator.cpp
./single_particle/ctf/aberration_estimator.cpp
./single_particle/ctf/defocus_helper.cpp
./single_particle/ctf/ctf_refiner_mpi.cpp
./single_particle/ctf/tilt_helper.cpp
./single_particle/ctf/tilt_estimator.cpp
./single_particle/ctf/ctf_refiner.cpp
./single_particle/ctf/bfactor_refiner.cpp
./single_particle/ctf/magnification_estimator.cpp
./single_particle/ctf/modular_ctf_optimisation.cpp
./single_particle/ctf/delocalisation_helper.cpp
./single_particle/slice_helper.cpp
./single_particle/spectral_helper.cpp
./single_particle/obs_model.cpp
./single_particle/ctf_helper.cpp
./single_particle/image_log.cpp
./single_particle/reference_map.cpp
./single_particle/volume_converter.cpp
./single_particle/convolution_helper.cpp
./single_particle/vtk_helper.cpp
./single_particle/refinement_helper.cpp
./single_particle/io/star_converter.cpp
./single_particle/complex_io.cpp
./single_particle/apps/delete_blobs_2d.cpp
./single_particle/apps/backproject_2d.cpp
./single_particle/apps/spa_backproject.cpp
./single_particle/t_complex.cpp
./single_particle/class_helper.cpp
./single_particle/distribution_helper.cpp
./single_particle/img_proc/image_op.cpp
./single_particle/img_proc/filter_helper.cpp
./single_particle/parallel_ft.cpp
./single_particle/fsc_helper.cpp
./single_particle/damage_helper.cpp
./single_particle/local_motion_fit.cpp
./single_particle/legacy_obs_model.cpp
./single_particle/micrograph_handler.cpp
./single_particle/noise_helper.cpp
./single_particle/stack_helper.cpp
./single_particle/new_ft.cpp
./single_particle/motion/motion_estimator.cpp
./single_particle/motion/gp_motion_fit.cpp
./single_particle/motion/motion_param_estimator.cpp
./single_particle/motion/frame_recombiner.cpp
./single_particle/motion/motion_refiner.cpp
./single_particle/motion/motion_helper.cpp
./single_particle/motion/two_hyperparameter_fit.cpp
./single_particle/motion/alignment_set.cpp
./single_particle/motion/motion_refiner_mpi.cpp
./single_particle/motion/three_hyperparameter_fit.cpp
./single_particle/programs/backproject_2d.cpp
./single_particle/programs/delete_blobs_2d.cpp
./single_particle/programs/spa_backproject.cpp
41c41
< 
---
> 	
53c53
< 
---
> 	
62c62
< 
---
> 	
79c79
< 
---
> 	
85c85
< 
---
> 	
95c95
< 
---
> 	
112,113c112,113
< 
< 
---
> 	
> 	
117c117
< 
---
> 	
123c123
< 
---
> 	
125c125
< 
---
> 	        
128c128
< 
---
> 		
146c146
< 
---
> 	
154c154
< 
---
> 	
184c184
< 		model.read(fn_noise, obsModel.opticsMdt.numberOfObjects());
---
> 		model.read(fn_noise);
244c244
< 
---
> 	
272c272
< 
---
> 	
278c278
< 					2 * num_threads_out,
---
> 					2 * num_threads_out, 
283c283
< 
---
> 		
294c294
< 
---
> 		
349c349
< 
---
> 	
355c355
< 
---
> 	
360c360
< 
---
> 		
383c383
< 
---
> 	
397c397
< 
---
> 	
400c400
< 
---
> 	
407c407
< 
---
> 	
413,414c413,414
< 	// (to avoid creating an Ewald ellipsoid)
< 
---
> 	// (to avoid creating an Ewald ellipsoid)	
> 	
419c419
< 
---
> 	
424c424
< 
---
> 	
429c429
< 
---
> 	
431,433c431,433
< 
< 
< 
---
> 	
> 	
> 	
443c443
< 
---
> 		
449c449
< 
---
> 	
453c453
< 
---
> 		
468a469,482
> 		FileName fn_group;
> 		
> 		if (DF.containsLabel(EMDL_MLMODEL_GROUP_NAME))
> 		{
> 			DF.getValue(EMDL_MLMODEL_GROUP_NAME, fn_group);
> 		}
> 		else if (DF.containsLabel(EMDL_MICROGRAPH_NAME))
> 		{
> 			DF.getValue(EMDL_MICROGRAPH_NAME, fn_group);
> 		}
> 		else
> 		{
> 			REPORT_ERROR("ERROR: cannot find rlnGroupName or rlnMicrographName in the input --i file.");
> 		}
470,471c484,505
< 		int optics_group = 0;
< 		DF.getValue(EMDL_IMAGE_OPTICS_GROUP, optics_group);
---
> 		int my_mic_id = -1;
> 		
> 		for (int mic_id = 0; mic_id < model.group_names.size(); mic_id++)
> 		{
> 			if (fn_group == model.group_names[mic_id])
> 			{
> 				my_mic_id = mic_id;
> 				break;
> 			}
> 		}
> 
> 		if (my_mic_id < 0) 
> 		{
> 			REPORT_ERROR("ERROR: cannot find " + fn_group + " in the input model file.");
> 		}
> 
> 		RFLOAT normcorr = 1.;
> 		
> 		if (DF.containsLabel(EMDL_IMAGE_NORM_CORRECTION)) 
> 		{
> 			DF.getValue(EMDL_IMAGE_NORM_CORRECTION, normcorr);
> 		}
481c515
< 			RFLOAT sigma = sqrt(DIRECT_A1D_ELEM(model.sigma2_noise[optics_group], ires));
---
> 			RFLOAT sigma = sqrt(DIRECT_A1D_ELEM(model.sigma2_noise[my_mic_id], ires));
486c520
< 
---
> 	
490c524
< 
---
> 	
500c534
< 
---
> 		
502c536
< 
---
> 	
519c553
< 
---
> 			
523c557
< 
---
> 			
525c559
< 
---
> 			
598c632
< 
---
> 		
611c645
< 
---
> 		
613c647
< 
---
> 		
620c654
< 
---
> 		
635c669
< 
---
> 			
640c674
< 
---
> 				
654c688
< 
---
> 			
662c696
< 
---
> 			
693c727
< 
---
> 		
699c733
< 
---
> 		
708c742
< 
---
> 			
730c764
< 
---
> 				
732c766
< 
---
> 				
737c771
< 
---
> 					
747,748c781,782
< 
< 				CtfHelper::CTFP_CTFQ_Pair<RFLOAT> dataImagePQ =
---
> 				
> 				CtfHelper::CTFP_CTFQ_Pair<RFLOAT> dataImagePQ = 
750c784
< 
---
> 				
755c789
< 
---
> 				
771c805
< 
---
> 				
774c808
< 					 accumulation_volume->data,
---
> 					 accumulation_volume->data, 
808c842
< 
---
> 						
823c857
< 
---
> 	
825c859
< 
---
> 		
830,831c864,865
< 
< 	for (int subset = 0; subset < 2; subset++)
---
> 	
> 	for (int subset = 0; subset < 2; subset++)	
837,838c871,872
< 
< 
---
> 	
> 	
845c879
< 
---
> 		
847c881
< 
---
> 		
852c886
< 
---
> 		
854c888
< 					nr_helical_asu, helical_twist, helical_rise/angpix,
---
> 					nr_helical_asu, helical_twist, helical_rise/angpix, 
856c890
< 
---
> 	
858c892
< 
---
> 		
865c899
< 
---
> 			
868c902
< 
---
> 			
872c906
< 
---
> 					
875,876c909,910
< 
< 
---
> 			
> 			
882c916
< 
---
> 	
886c920
< 
---
> 					
893c927
< 
---
> 					
897c931
< 
---
> 				
904c938
< 
---
> 					
909c943
< 
---
> 					
914c948
< 
---
> 					
927c961
< 
---
> 				
931c965
< 
---
> 				
936c970
< 
---
> 				
938c972
< 
---
> 				
943c977
< 
---
> 				
948c982
< 
---
> 	
950,951c984,985
< 
< 			if (do_use_fsc)
---
> 			
> 			if (do_use_fsc) 
957c991
< 
---
> 				
961c995
< 
---
> 				
964c998
< 
---
> 				
969c1003
< 
---
> 					
972c1006
< 
---
> 				
974c1008
< 
---
> 				
977c1011
< 
---
> 	
984,985c1018,1019
< 
< 				FileName fn_root = fn_out.withoutExtension() + "_half_" + ZIO::itoa(subset+1);
---
> 				
> 				FileName fn_root = fn_out.withoutExtension() + "_half_" + ZIO::itoa(subset+1);			
987c1021
< 
---
> 				
997c1031
< 
---
> 				
1001c1035
< 
---
> 		
1003c1037
< 
---
> 		
1006c1040
< 
---
> 		
1011c1045
< 
---
> 		
1049c1083
< 
---
> 	
1099c1133
< 
---
> 	
1104c1138
< 
---
> 	
1117c1151
< 
---
> 	
1125,1126c1159,1160
< 
< 
---
> 		
> 		
1180c1214
< 			dataImgFS_both, dataImgRS[0],
---
> 			dataImgFS_both, dataImgRS[0], 
1257c1291
< 
---
> 	
1264c1298
< 	Log::beginSection("Reconstructing");
---
> 	Log::beginSection("Reconstructing");	
1406c1440
< 
---
> 	
1411c1445
< 
---
> 		
1437c1471
< 
---
> 				
1456c1490
< 
---
> 			
1463c1497
< 
---
> 			
1465c1499
< 
---
> 			
1493c1527
< 
---
> 				
./single_particle/Gaussian_pyramid.cpp
./single_particle/resampling_helper.cpp
./single_particle/tomo/tomo_stack.cpp
./single_particle/tomo/projection_helper.cpp
./single_particle/tomo/backprojection_helper.cpp
./single_particle/jaz_config.cpp
./single_particle/interpolation.cpp
./math/fcc.cpp
./math/Zernike.cpp
./math/spherical_coordinates.cpp
./math/spherical_harmonics.cpp
./math/fft_buffer.cpp
./math/t_complex.cpp
./math/Zernike_helper.cpp
./math/rigid_alignment.cpp
./math/fft.cpp
./math/svd_helper.cpp
./math/Gaussian_process.cpp
./optics/tomo_mag_fit.cpp
./optics/damage.cpp
./optics/ctf_helper.cpp
./optics/astigmatism_fit.cpp
./optics/aberration_fit.cpp
./optics/aberrations_cache.cpp
./optics/tile_ctf_cost.cpp
./optics/magnification_helper.cpp
./optics/optics_data.cpp
./optics/spectral_ctf_cost.cpp
./optics/ctf_equiphase_fit.cpp
./archive/programs/polish.cpp
./archive/programs/frame_alignment_program.cpp
./archive/programs/defocus_refinement.cpp
./archive/programs/aberration_fit.cpp
./archive/apps/polish.cpp
./archive/apps/substack.cpp
./archive/apps/add_tomo.cpp
./archive/apps/align_frames.cpp
./archive/apps/refine_defocus.cpp
./archive/apps/fit_aberrations.cpp
./util/zio.cpp
./util/topaz_helper.cpp
./util/ansi_codes.cpp
./util/log.cpp
./util/image_file_helper.cpp
./image/color_helper.cpp
./image/stack_helper.cpp
./image/symmetry.cpp
./image/structure_tensor.cpp
./image/resampling.cpp
./image/radial_avg.cpp
./tomography/tomo_ctf_find.cpp
./tomography/motion/modular_alignment/spline_2D_deformation_model.cpp
./tomography/motion/modular_alignment/no_motion_model.cpp
./tomography/motion/modular_alignment/no_2D_deformation_model.cpp
./tomography/motion/modular_alignment/GP_motion_model.cpp
./tomography/motion/modular_alignment/modular_alignment.cpp
./tomography/motion/spectral_alignment.cpp
./tomography/motion/spline_2D_deformation.cpp
./tomography/motion/trajectory_set.cpp
./tomography/motion/motion_fit.cpp
./tomography/motion/trajectory.cpp
./tomography/motion/proto_alignment.cpp
./tomography/prediction.cpp
./tomography/projection_IO.cpp
./tomography/fiducials.cpp
./tomography/lattice/motif.cpp
./tomography/lattice/motif_alignment.cpp
./tomography/lattice/motif_refinement.cpp
./tomography/lattice/motif_detection.cpp
./tomography/lattice/point_cloud.cpp
./tomography/particle_set.cpp
./tomography/apps/predict_tilt_series.cpp
./tomography/apps/align_mpi.cpp
./tomography/apps/local_particle_refine.cpp
./tomography/apps/refine_mag.cpp
./tomography/apps/reconstruct_particle.cpp
./tomography/apps/tomo_ctf.cpp
./tomography/apps/refine_ctf.cpp
./tomography/apps/convert_projections.cpp
./tomography/apps/catalogue_tomos.cpp
./tomography/apps/subtomo_mpi.cpp
./tomography/apps/fit_bfactors.cpp
./tomography/apps/reconstruct_tomogram.cpp
./tomography/apps/make_optimisation_set.cpp
./tomography/apps/Wiener_divide.cpp
./tomography/apps/make_reference.cpp
./tomography/apps/discover_motif.cpp
./tomography/apps/reconstruct_particle_mpi.cpp
./tomography/apps/import_particles.cpp
./tomography/apps/align.cpp
./tomography/apps/powspec.cpp
./tomography/apps/add_spheres.cpp
./tomography/apps/import_tomograms.cpp
./tomography/apps/dark_erase.cpp
./tomography/apps/fit_blobs_3d.cpp
./tomography/apps/find_lattice.cpp
./tomography/apps/compute_FCC.cpp
./tomography/apps/bin_stack.cpp
./tomography/apps/template_pick.cpp
./tomography/apps/delete_blobs.cpp
./tomography/apps/find_fiducials.cpp
./tomography/apps/refine_ctf_mpi.cpp
./tomography/apps/subtomo.cpp
./tomography/apps/taper.cpp
./tomography/apps/sample_manifold.cpp
./tomography/dynamo/catalogue.cpp
./tomography/dynamo/dynamo_particle.cpp
./tomography/tomogram_set.cpp
./tomography/tilt_geometry.cpp
./tomography/programs/tomo_ctf.cpp
./tomography/programs/reconstruct_particle.cpp
./tomography/programs/reconstruct_particle_mpi.cpp
./tomography/programs/mag_fit.cpp
./tomography/programs/fit_blobs_3d.cpp
./tomography/programs/subtomo.cpp
./tomography/programs/align_mpi.cpp
./tomography/programs/powspec.cpp
./tomography/programs/template_picker.cpp
./tomography/programs/ctf_refinement.cpp
./tomography/programs/find_lattice.cpp
./tomography/programs/reconstruct_tomogram.cpp
./tomography/programs/convert_projections.cpp
./tomography/programs/delete_blobs.cpp
./tomography/programs/find_fiducials.cpp
./tomography/programs/dark_erase.cpp
./tomography/programs/sample_manifold.cpp
./tomography/programs/subtomo_mpi.cpp
./tomography/programs/bfactor_fit.cpp
./tomography/programs/local_particle_refine.cpp
./tomography/programs/align.cpp
261a262
> 
./tomography/programs/fcc_computation.cpp
./tomography/programs/refinement.cpp
./tomography/programs/discover_motif.cpp
./tomography/programs/ctf_refinement_mpi.cpp
./tomography/dynamo_data_set.cpp
./tomography/manifold/manifold_set.cpp
./tomography/manifold/CMM_loader.cpp
./tomography/manifold/spheroid.cpp
./tomography/manifold/manifold_loader.cpp
./tomography/manifold/sphere.cpp
./tomography/imod_import.cpp
./tomography/optimisation_set.cpp
./tomography/tomo_ctf_helper.cpp
./tomography/tomolist.cpp
./tomography/reference_map.cpp
./tomography/tomogram.cpp
./tomography/local_particle_refinement.cpp
./tomography/imod_helper.cpp
./tomography/filament/closest_spline_point_problem.cpp
./tomography/filament/filament_fit.cpp
./tomography/filament/membrane_template.cpp
./tomography/filament/circular_Fourier_filament_model.cpp
./tomography/filament/filament_model.cpp
./tomography/filament/filament_mapping.cpp
./tomography/filament/filament.cpp
./tomography/filament/multi_filament_fit.cpp
./segmentation/diffusion_tensors.cpp
./segmentation/primal_dual_TV.cpp
./segmentation/skeletonization.cpp
./atomic/pdb_helper.cpp
./mesh/triangle.cpp
./mesh/mesh.cpp
./mesh/mesh_builder.cpp
./membrane/tilt_space_blob_fit.cpp
./membrane/membrane_fit.cpp
./membrane/membrane_segmentation.cpp
./membrane/point_blob_fit_2d.cpp
./membrane/quadric_disc_fit.cpp
./membrane/phaseline_average.cpp
./membrane/blob_3d.cpp
./membrane/area_point_blob_fit.cpp
./membrane/global_blob_fit.cpp
./membrane/cell_blob_fit.cpp
./membrane/blob_fit_2d.cpp
./membrane/multi_blob_fit.cpp
./membrane/blob_fit_3d.cpp
./membrane/cells.cpp
./membrane/blob_2d.cpp
./optimization/lbfgs.cpp
./optimization/recursive_line_search.cpp
./optimization/nelder_mead.cpp
./optimization/gradient_descent.cpp
./optimization/optimization.cpp
./optimization/random_walk.cpp
./scripts/membrane_segment.cpp
./scripts/scratch.cpp
./scripts/rotate_subtomograms.cpp
./scripts/plot_DC_analysis.cpp
./scripts/membrane_erase_2D.cpp
./scripts/sample_blob_points.cpp
./scripts/predict_tomo_view.cpp
./scripts/suppress_cone.cpp
./scripts/print_coords.cpp
./scripts/plot_topaz_points.cpp
./scripts/measure_scale.cpp
./scripts/test_logger.cpp
./scripts/dose_convert.cpp
./scripts/process_image.cpp
./scripts/align_2d_classes.cpp
./scripts/sort_2d_classes.cpp
./scripts/conversion_test.cpp
./scripts/shift_plot.cpp
./scripts/img_test.cpp
./scripts/scale_test.cpp
./scripts/ref_delete_3d.cpp
./scripts/plot_dose_weight.cpp
./scripts/Ewald_test.cpp
./scripts/find_blobs_2d.cpp
./scripts/fit_class_blobs.cpp
./scripts/ramp.cpp
./scripts/membrane_erase_3D.cpp
./scripts/box_PCA.cpp
./scripts/cuda_test.cpp
./scripts/extract_blob_points.cpp
./scripts/imod_test.cpp
./scripts/membrane_dist.cpp
./scripts/BP_test.cpp
./scripts/blobs_from_points.cpp
./scripts/plot_2d_classes.cpp
./scripts/update_tomogram_set.cpp
./scripts/analyse_dual_contrast.cpp
./scripts/deramp.cpp
./scripts/add_subset.cpp
./scripts/test_splines.cpp
./scripts/defilament.cpp
./scripts/measure_noise.cpp
./scripts/alignment_test_000.cpp
./scripts/enumerate_micrographs.cpp
./scripts/CTFPQ_test.cpp
./scripts/plot_tomo_defoci.cpp
./scripts/plot_particles.cpp
./scripts/test_extraction.cpp
./scripts/add_tomogram_name.cpp
./scripts/predict_view.cpp
./scripts/plot_pdb.cpp
