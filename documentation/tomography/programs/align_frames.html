<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>Align Frames</title>
	<link rel="stylesheet" href="../style.css">
</head>

<body>
	<h1><tt>relion_tomo_align_frames</tt></h1>
	
	<p>This program refines the projections that map 3D space onto the images of the tilt series. Each projection is optimised using the full 5 degrees of freedom: the assumption of a common tilt axis is abandoned. The particle positions in 3D are also optimised by the program, because those cannot be assumed to be known in advance: they have only been inferred from the observed 2D positions of the particles in the individual frames. Therefore, this program looks for the optimal set of 3D positions <i>and</i> viewing angles and shifts that maximise similarity between the observed images and projections of the high-resolution 3D reference.</p>
	
	<p>Even though the <i>static</i> positions of the particles are changed by this program, it does not estimate the motion of the particles <i>over time</i>. In order to estimate the trajectories of particle motion as well, please use <a href="polish.html"><b><tt>relion_tomo_polish</tt></b></a>. Otherwise, the two programs are identical.</p>
	
	<p>The estimated projection matrices are written into the output <a href="../data_types/tomogram_set.html">tomogram set</a> and the estimated particle positions into the output <a href="../data_types/particle_set.html">particle set</a> which replace the given tomogram and particle sets in the output <a href="../data_types/optimisation_set.html">optimisation set</a>.</p>
	
	<h3>Relevant program arguments:</h3>
	
	<ul>
		<li><b>--i</b> and/or <b>--p</b>, <b>--t</b>, <b>--mot</b>, <b>--ref&lt;1/2&gt;</b>, <b>--mask</b> and <b>--fsc</b>: input optimisation-set and/or its components (see <a href="../data_types/optimisation_set.html">optimisation set</a>).</li>
		<li><b>--b</b>: box size to be used for the estimation. Note that this can be larger than the box size of the reference map. A sufficiently large box size allows more of the high-frequency signal to be captured that has been delocalised by the CTF.</li>
		<li><b>--r</b>: maximal assumed error in the initial 2D particle-positions (distances between the projected 3D positions and their true positions in the images), given in pixels.</li>
		<li><b>--j</b>: number of threads to be used. This should be set to the number of CPU cores available.</li>
		<li><b>--o</b>: name of the output directory (that will be created).</li>
	</ul>
	
	<h3>Program output:</h3>
	
	<p>After running the program, the output directory (<tt>--o</tt> argument) will contain the following items:</p>
	<ul>
		<li><b>tomograms.star</b>: a new tomogram set containing the newly estimated projection matrices (<tt>rlnTomoProj&lt;X/Y/Z/W&gt;</tt>)</li>
		<li><b>particles.star</b>: a new particles set containing the newly estimated particle positions in 3D (<tt>rlnCoordinate&lt;X/Y/Z&gt;</tt>)</li>
		<li><b>optimisation_set.star</b>: a new optimisation set pointing to the new tomogram and particle sets.</li>
		<li><b>note.txt</b>: a text file containing the command issued to run the program.</li>
	</ul>
	
	
</body>

</html>
